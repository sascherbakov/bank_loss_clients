# Отток клиентов из банка

## Задача
Из банка стали уходить клиенты. Сохранять текущих клиентов дешевле, чем привлекать новых, поэтому стоит задача спрогнозировать, уйдёт клиент из банка в ближайшее время или нет.

## Данные
Для прогнозирования были предоставлены так данные как ФИО, пол, возраст, страна проживания, кредитный рейтинг и зарплата клиента, а так же есть ли недвижимость, сколько денег на счете, что из продуктов банка клиент оформил и насколько он активен в качестве клиента банка.

## Используемые библиотеки
Pandas, Numpy, Matplotlib, Scipy, Sklearn

## Что было сделано
Предоставленные данные были просмотрены и предобработаны. Для предобработки данных использовалась техника прямого кодирования (ОНЕ), так как используемые модели не могли работать с категориальными переменными. Была проведена проверка на мультиколлинеарность признаков и исключены некоторые признаки, потом подговлены данные для обучения с разбивкой на обучающую и тестовые выборки. При обучении модели был выявлен дисбаланс в данных и проведена работа по борьбе с дисбалансом тремя способами: использованием весов при обучении, увеличении, а так же уменьшении обучающей выборки для уравновешивании баланса между классами. И было обучено три модели: Решающее дерево, Логистическая регрессия и Случайный лес.

## Выводы
Было обучено три модели, из них выбрана та, что показала наилучшее значение метирики выбранной заказчиком среди всех моделей и превышающее пороговое значение занное заказчиком. ДЛя оценки использовалась f1-мера, требуемое значение 0,59, итоговое которое получилось 0,60. Но что не менее важно, то что до исправления дисбанса модель теряла 246 клиентов (считала что они не уйдут, а эти клиенты уходили из банка), то уравновешивании баланса между классами таких клеинтов осталось уже только 116, ошибка модели упала более чем в 2 раза.

#### Ссылка на сам код с данными и проведенным анализом: https://github.com/sascherbakov/bank_loss_clients/blob/main/bank_loss_clients.ipynb
